{% extends 'core/base.html' %}
{% load static %}

{% block content %}
<div class="container mx-auto px-4 py-8">
  <div class="max-w-4xl mx-auto bg-white shadow rounded-lg p-6">

    <!-- Main Product Image -->
    <div class="w-full max-w-md mx-auto">
      <img id="mainImage" src="{{ images.0.image.url }}" alt="{{ product.name }}"
        class="w-full h-[350px] object-cover object-center rounded-lg shadow border transition duration-300 ease-in-out" />
    </div>

    <!-- Thumbnails -->
    <div class="flex justify-center gap-3 mt-4">
      {% for img in images %}
      <img src="{{ img.image.url }}" alt="Thumbnail {{ forloop.counter }}"
        class="thumbnail w-20 h-20 object-cover rounded-md border cursor-pointer hover:ring-2 ring-pink-400 transition duration-200" />
      {% endfor %}
    </div>

    <!-- Product Info -->
    <h1 class="text-3xl font-bold text-gray-800">{{ product.name }}</h1>
    <p class="text-pink-600 text-xl mt-2 font-semibold">₹{{ product.price }}</p>
    <p class="mt-4 text-gray-600">{{ product.description }}</p>

    <div class="flex gap-4 mt-6">
      {% if user.is_authenticated %}

      <a href="{% url 'add_to_wishlist' product.id %}"
        class="bg-pink-100 text-pink-600 px-4 py-2 rounded hover:bg-pink-200">❤️ Wishlist</a>
      <a href="{% url 'add_to_cart' product.id %}"
        class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">🛒 Add to Cart</a>
      {% else %}
      <a href="{% url 'user:user_login' %}" class="...">🔒 Login to add to cart</a>
      {% endif %}

    </div>

    {% if product.stock == 0 %}
    <span class="text-red-600 mt-4 block font-semibold">Out of Stock</span>
    {% endif %}

  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const thumbnails = document.querySelectorAll('.thumbnail');
    const mainImage = document.getElementById('mainImage');

    thumbnails.forEach(thumbnail => {
      thumbnail.addEventListener('click', function () {
        const newSrc = this.getAttribute('src');
        mainImage.setAttribute('src', newSrc);
      });
    });
  });
</script>
{% endblock %}