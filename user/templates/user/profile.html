{% extends 'core/base.html' %}
{% load static %}
{% block content %}
<section class="max-w-6xl mx-auto py-10 px-4">

    <h1 class="text-3xl font-semibold mb-8">👤 My Profile</h1>

    {% if messages %}
    {% for message in messages %}
    <div class="bg-green-100 text-green-800 px-4 py-2 rounded mb-4 shadow">
        {{ message }}
    </div>
    {% endfor %}
    {% endif %}

    <div class="flex flex-col md:flex-row gap-6">
        {% include 'user/profile_sidebar.html' %}

        <!-- Main Profile Content -->
        <div class="flex-1 space-y-10">
            <!-- Profile Card -->
            <div class="bg-white shadow p-6 rounded-xl flex flex-col md:flex-row items-start gap-6">
                <!-- Profile Image -->
                <div class="flex-shrink-0">
                    {% if user.profile_image %}
                    <img src="{{ user.profile_image.url }}" alt="Profile Image"
                        class="w-32 h-32 rounded-full object-cover shadow">
                    {% else %}
                    <img src="{% static 'images/default_profile.png' %}" alt="Default"
                        class="w-32 h-32 rounded-full object-cover shadow">
                    {% endif %}
                </div>

                <!-- User Info -->
                <div class="flex-1">
                    <p><strong>Full Name:</strong> {{ user.first_name }} {{ user.last_name }}</p>
                    <p><strong>Email:</strong> {{ user.email }}</p>
                    <p><strong>Phone:</strong> {{ user.phone }}</p>
                    <p><strong>Wallet Balance:</strong> ₹{{ user.wallet.balance }}</p>
                    <hr class="my-4">
                    <p><strong>Joined:</strong> {{ user.date_joined|date:"F j, Y" }}</p>
                </div>
            </div>


            <!-- Addresses -->
            <div id="addresses">
                <h2 class="text-2xl font-semibold mb-4">🏠 Saved Addresses</h2>
                {% if addresses %}
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    {% for address in addresses %}
                    <div class="border p-4 rounded-md bg-gray-50 shadow-sm">
                        <p><strong>{{ address.name }}</strong>
                            {% if address.is_default %}
                            <span class="text-sm text-green-600">(Default)</span>
                            {% endif %}
                        </p>
                        <p>{{ address.phone }}</p>
                        <p>{{ address.address_line1 }}</p>
                        {% if address.address_line2 %}<p>{{ address.address_line2 }}</p>{% endif %}
                        <p>{{ address.city }}, {{ address.state }} - {{ address.postal_code }}</p>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <p class="text-gray-500">No addresses saved yet.</p>
                {% endif %}
            </div>

            <!-- Baby Profiles -->
            <div id="babies">
                <h2 class="text-2xl font-semibold mb-4">👶 Baby Profiles</h2>
                {% if baby_profiles %}
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    {% for baby in baby_profiles %}
                    <div class="border p-4 rounded-md bg-white shadow-sm flex items-start gap-4">
                        <div
                            class="w-10 h-10 bg-yellow-100 text-yellow-800 rounded-full flex items-center justify-center font-bold text-xl">
                            👶
                        </div>
                        <div class="flex-1">
                            <p><strong>Name:</strong> {{ baby.baby_name|default:"N/A" }}</p>
                            <p><strong>DOB:</strong> {{ baby.baby_dob|date:"M d, Y"|default:"N/A" }}</p>
                            <p><strong>Gender:</strong> {{ baby.baby_gender|default:"N/A" }}</p>
                            <p><strong>Weight:</strong> {{ baby.birth_weight|default:'' }} kg</p>
                            <p><strong>Height:</strong> {{ baby.birth_height|default:'' }} cm</p>
                            {% if baby.notes %}<p><strong>Notes:</strong> {{ baby.notes }}</p>{% endif %}
                            <div class="mt-3 flex gap-2">
                                <a href="{% url 'user:edit_baby_profile' baby.id %}"
                                    class="text-blue-600 underline">Edit</a>
                                <a href="{% url 'user:delete_baby_profile' baby.id %}"
                                    class="text-red-600 underline">Delete</a>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <p class="text-gray-500">No baby profiles added yet.</p>
                {% endif %}
            </div>
        </div>
    </div>
</section>
{% endblock %}