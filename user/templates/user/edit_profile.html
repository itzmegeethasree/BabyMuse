{% extends 'core/base.html' %}
{% load cart_extras %}

{% block content %}
<section class="max-w-2xl mx-auto py-10">
    <h1 class="text-3xl font-semibold mb-6">✏️ Edit Profile</h1>

    {% if messages %}
    {% for message in messages %}
    <p class="text-green-600 mb-2">{{ message }}</p>
    {% endfor %}
    {% endif %}

    <form method="POST" enctype="multipart/form-data" class="space-y-6 bg-white p-6 rounded-xl shadow">
        {% csrf_token %}

        <!-- Profile Image -->
        <div>
            {% if user.profile_image %}
            <img src="{{ user.profile_image.url }}" alt="Profile Image"
                class="w-24 h-24 rounded-full object-cover shadow mb-2">
            {% endif %}
            <label class="block text-gray-700">Change Profile Image</label>
            <input type="file" name="profile_image" class="border rounded px-3 py-2 w-full" />
        </div>

        <!-- First Name -->
        <div>
            <label class="block text-gray-700">First Name</label>
            <input type="text" name="first_name" value="{{ user.first_name }}" class="border rounded px-3 py-2 w-full"
                required />
        </div>

        <!-- Last Name -->
        <div>
            <label class="block text-gray-700">Last Name</label>
            <input type="text" name="last_name" value="{{ user.last_name }}" class="border rounded px-3 py-2 w-full"
                required />
        </div>

        <!-- Email -->
        <div>
            <label class="block text-gray-700">Email</label>
            <input type="email" name="email" value="{{ user.email }}" class="border rounded px-3 py-2 w-full"
                required />
            <small class="text-sm text-gray-500">Changing email will require OTP verification.</small>
        </div>

        <!-- Phone -->
        <div>
            <label class="block text-gray-700">Phone Number</label>
            <input type="text" name="phone" value="{{ user.phone }}" class="border rounded px-3 py-2 w-full" />
        </div>

        <!-- Baby Name -->
        <div>
            <label class="block text-gray-700">Baby Name</label>
            <input type="text" name="baby_name" value="{{ profile.baby_name }}"
                class="border rounded px-3 py-2 w-full" />
        </div>

        <!-- Baby DOB -->
        <div>
            <label class="block text-gray-700">Baby Date of Birth</label>
            <input type="date" name="baby_dob" value="{{ profile.baby_dob|date:'Y-m-d' }}"
                class="border rounded px-3 py-2 w-full" />
        </div>

        <!-- Baby Gender -->
        <div>
            <label class="block text-gray-700">Baby Gender</label>
            <select name="baby_gender" class="border rounded px-3 py-2 w-full">
                <option value="">-- Select --</option>
                <option value="Male" {% if profile.baby_gender|equals:"Male" %}selected{% endif %}>Male</option>
                <option value="Female" {% if profile.baby_gender|equals:"Female" %}selected{% endif %}>Female</option>
            </select>
        </div>

        <div class="flex justify-between items-center mt-6">
            <a href="{% url 'user:profile' %}" class="text-blue-600 underline">← Back to Profile</a>
            <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
                Save Changes
            </button>
        </div>
    </form>
</section>
{% endblock %}